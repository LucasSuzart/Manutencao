import{d as $,u as h,a as g,O as x,c as i,b as S,o as N,e as n,j as r,i as o,S as d,w as m,D as p,B as c,_ as T}from"./index-OLFv1jP5.js";const R={class:"page"},q={class:"stats-grid"},B=$({__name:"CostsView",setup(F){const l=h(),y=g(),b=x(),u=i(()=>{const s=l.workOrders.reduce((e,a)=>e+a.costs.parts,0),t=l.workOrders.reduce((e,a)=>e+a.costs.labor,0);return{parts:s,labor:t,total:s+t}}),v=i(()=>{const s=l.workOrders.reduce((t,e)=>(e.assetId&&(t[e.assetId]||(t[e.assetId]={parts:0,labor:0,total:0,workOrders:0}),t[e.assetId].parts+=e.costs.parts,t[e.assetId].labor+=e.costs.labor,t[e.assetId].total+=e.costs.total,t[e.assetId].workOrders+=1),t),{});return Object.entries(s).map(([t,e])=>{var a;return{assetId:t,assetName:((a=y.byId(t))==null?void 0:a.name)||"Desconhecido",...e}}).sort((t,e)=>e.total-t.total)}),k=i(()=>{const s=l.workOrders.reduce((t,e)=>(t[e.type]||(t[e.type]={parts:0,labor:0,total:0,count:0}),t[e.type].parts+=e.costs.parts,t[e.type].labor+=e.costs.labor,t[e.type].total+=e.costs.total,t[e.type].count+=1,t),{});return Object.entries(s).map(([t,e])=>({type:t,typeName:{corrective:"Corretiva",preventive:"Preventiva",predictive:"Preditiva",inspection:"Inspeção",improvement:"Melhoria"}[t]||t,...e}))}),f=i(()=>{const s=l.workOrders.reduce((t,e)=>(e.parts.forEach(a=>{t[a.inventoryItemId]||(t[a.inventoryItemId]={quantity:0,cost:0}),t[a.inventoryItemId].quantity+=a.quantity,t[a.inventoryItemId].cost+=a.quantity*a.unitCost}),t),{});return Object.entries(s).map(([t,e])=>{const a=b.items.find(O=>O.id===t);return{itemId:t,itemName:(a==null?void 0:a.name)||"Desconhecido",sku:(a==null?void 0:a.sku)||"",quantity:e.quantity,totalCost:e.cost}}).sort((t,e)=>e.totalCost-t.totalCost).slice(0,10)}),C=[{key:"assetName",label:"Ativo"},{key:"workOrders",label:"OS",format:s=>s.toString()},{key:"parts",label:"Peças",format:s=>`R$ ${s.toFixed(2)}`},{key:"labor",label:"Mão de Obra",format:s=>`R$ ${s.toFixed(2)}`},{key:"total",label:"Total",format:s=>`R$ ${s.toFixed(2)}`}],I=[{key:"typeName",label:"Tipo de Manutenção"},{key:"count",label:"Quantidade",format:s=>s.toString()},{key:"parts",label:"Peças",format:s=>`R$ ${s.toFixed(2)}`},{key:"labor",label:"Mão de Obra",format:s=>`R$ ${s.toFixed(2)}`},{key:"total",label:"Total",format:s=>`R$ ${s.toFixed(2)}`}],_=[{key:"itemName",label:"Item"},{key:"sku",label:"SKU"},{key:"quantity",label:"Quantidade Utilizada"},{key:"totalCost",label:"Custo Total",format:s=>`R$ ${s.toFixed(2)}`}];return(s,t)=>(N(),S("div",R,[t[0]||(t[0]=n("div",{class:"page-header"},[n("div",{class:"page-header__content"},[n("h1",{class:"page-title"},"Análise de Custos"),n("p",{class:"page-subtitle"},"Controle e análise de custos de manutenção")])],-1)),n("div",q,[r(o(d),{title:"Total em Peças",value:u.value.parts,unit:"R$",color:"primary"},null,8,["value"]),r(o(d),{title:"Total em Mão de Obra",value:u.value.labor,unit:"R$",color:"warning"},null,8,["value"]),r(o(d),{title:"Custo Total",value:u.value.total,unit:"R$",color:"success"},null,8,["value"]),r(o(d),{title:"Ordens de Serviço",value:o(l).workOrders.length,decimals:0},null,8,["value"])]),r(o(c),{title:"Custos por Ativo",class:"mb-lg"},{default:m(()=>[r(o(p),{data:v.value,columns:C,sortable:"",striped:"",hoverable:"","empty-text":"Nenhum custo registrado por ativo"},null,8,["data"])]),_:1}),r(o(c),{title:"Custos por Tipo de Manutenção",class:"mb-lg"},{default:m(()=>[r(o(p),{data:k.value,columns:I,sortable:"",striped:"",hoverable:"","empty-text":"Nenhum custo registrado por tipo"},null,8,["data"])]),_:1}),r(o(c),{title:"Top 10 Itens Mais Utilizados"},{default:m(()=>[r(o(p),{data:f.value,columns:_,sortable:"",striped:"",hoverable:"","empty-text":"Nenhum item utilizado ainda"},null,8,["data"])]),_:1})]))}}),A=T(B,[["__scopeId","data-v-a9fc3ef6"]]);export{A as default};

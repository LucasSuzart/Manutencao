import{d as H,a as J,I as K,E as P,H as T,l as _,b as S,o as L,e as n,j as s,i,J as r,K as c,g as $,w as R,h as k,y as Q,x as q,G as W,_ as X}from"./index-CEWcok4S.js";const Y={class:"asset-form"},Z={class:"form-grid"},h={key:0,class:"image-preview"},ee=["src"],ae={class:"preview-actions"},le={class:"form-actions"},oe=H({__name:"AssetForm",props:{modelValue:{type:Object,required:!1}},emits:["update:modelValue","saved"],setup(A,{emit:B}){var V,g,b,U,y,N,w,C,I,x,F;const u=A,v=B,m=J(),M=K(),E=T(),p=W();P(()=>{if(!u.modelValue){const t=E.params.id;if(t){const e=m.byId(t);e&&(a.value={id:e.id,name:e.name||"",code:e.code||"",status:e.status||"operational",criticality:e.criticality||"medium",category:e.category||"",location:e.location||"",manufacturer:e.manufacturer||"",model:e.model||"",serialNumber:e.serialNumber||"",imageUrl:e.imageUrl||""})}}});function O(t){const e=[];return t.filter(o=>!o.parentId).forEach(o=>{e.push({value:o.id,label:o.name}),f(o.id,1,e,t)}),e}function f(t,e,l,o){o.filter(d=>d.parentId===t).forEach(d=>{const G="—".repeat(e)+" ";l.push({value:d.id,label:G+d.name+(d.code?` (${d.code})`:"")}),f(d.id,e+1,l,o)})}const a=_({id:((V=u.modelValue)==null?void 0:V.id)||null,name:((g=u.modelValue)==null?void 0:g.name)||"",code:((b=u.modelValue)==null?void 0:b.code)||"",status:((U=u.modelValue)==null?void 0:U.status)||"operational",criticality:((y=u.modelValue)==null?void 0:y.criticality)||"medium",category:((N=u.modelValue)==null?void 0:N.category)||"",location:((w=u.modelValue)==null?void 0:w.location)||"",manufacturer:((C=u.modelValue)==null?void 0:C.manufacturer)||"",model:((I=u.modelValue)==null?void 0:I.model)||"",serialNumber:((x=u.modelValue)==null?void 0:x.serialNumber)||"",imageUrl:((F=u.modelValue)==null?void 0:F.imageUrl)||""});function z(t){const e=t.target;if(!e.files||!e.files[0])return;const l=e.files[0],o=new FileReader;o.onload=()=>{a.value.imageUrl=o.result},o.readAsDataURL(l)}function j(){a.value.imageUrl=""}function D(){var t;if(!(!a.value.name||!a.value.code))if(a.value.id){const{imageUrl:e,...l}=a.value;m.update(a.value.id,{...l,imageUrl:e}),v("saved"),p.push({name:"asset-detail",params:{id:a.value.id}})}else{const{imageUrl:e,...l}=a.value;m.add({...l,imageUrl:e}),v("saved");const o=(t=m.assets[m.assets.length-1])==null?void 0:t.id;o&&p.push({name:"asset-detail",params:{id:o}})}}return(t,e)=>(L(),S("div",Y,[n("div",Z,[s(i(r),{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.name=l),label:"Nome do equipamento",required:""},null,8,["modelValue"]),s(i(r),{modelValue:a.value.code,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.code=l),label:"Código",required:""},null,8,["modelValue"]),s(i(c),{modelValue:a.value.status,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.status=l),options:[{value:"operational",label:"Operacional"},{value:"down",label:"Parado"},{value:"maintenance",label:"Manutenção"},{value:"retired",label:"Retirado"}],label:"Status"},null,8,["modelValue"]),s(i(c),{modelValue:a.value.criticality,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.criticality=l),options:[{value:"low",label:"Baixa"},{value:"medium",label:"Média"},{value:"high",label:"Alta"}],label:"Criticidade"},null,8,["modelValue"]),s(i(r),{modelValue:a.value.category,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.category=l),label:"Categoria (ex: Impressora Offset)"},null,8,["modelValue"]),s(i(c),{modelValue:a.value.location,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.location=l),options:O(i(M).locations),label:"Localização",placeholder:"Selecione a localização"},null,8,["modelValue","options"]),s(i(r),{modelValue:a.value.manufacturer,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.manufacturer=l),label:"Fabricante"},null,8,["modelValue"]),s(i(r),{modelValue:a.value.model,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.model=l),label:"Modelo"},null,8,["modelValue"]),s(i(r),{modelValue:a.value.serialNumber,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.serialNumber=l),label:"Número de Série"},null,8,["modelValue"]),n("div",null,[e[10]||(e[10]=n("label",{class:"label"},"Foto do equipamento",-1)),n("input",{type:"file",accept:"image/*",onChange:z},null,32),a.value.imageUrl?(L(),S("div",h,[n("img",{src:a.value.imageUrl,alt:"preview",class:"preview-img"},null,8,ee),n("div",ae,[s(i(q),{variant:"ghost",size:"sm",onClick:Q(j,["prevent"])},{default:R(()=>[...e[9]||(e[9]=[k("Remover",-1)])]),_:1})])])):$("",!0)])]),n("div",le,[s(i(q),{variant:"primary",onClick:D},{default:R(()=>[...e[11]||(e[11]=[k("Salvar",-1)])]),_:1})])]))}}),ie=X(oe,[["__scopeId","data-v-84d02dd0"]]);export{ie as default};

import{d as L,G as W,a as F,I as U,u as G,c as g,m as H,b as h,o as c,e as s,t as l,j as d,w as a,h as m,i as n,s as b,B as p,f as A,g as O,k as C,F as J,r as K,E as X,_ as Y}from"./index-OLFv1jP5.js";import{Q as Z}from"./QRPanel-utyet_ZQ.js";const ss={key:0,class:"asset-detail page"},es={class:"page-header"},ts={class:"asset-header"},is={class:"asset-title"},as={class:"muted"},os={class:"detail-grid"},ls={class:"detail-main"},ns={class:"info-grid"},ds={class:"info-row"},rs={class:"info-value"},us={class:"info-row"},vs={class:"info-value"},cs={class:"info-row"},ms={class:"info-value"},ps={class:"info-row"},fs={class:"info-value"},gs={class:"info-row"},_s={class:"info-value"},ys={class:"info-row"},hs={class:"info-value"},bs={key:0,class:"empty-item"},ws={class:"order-summary"},ks={class:"order-summary-item"},qs={class:"order-summary-header"},Os={class:"order-count"},As={class:"order-summary-action"},Cs={class:"order-summary-item"},Is={class:"order-summary-header"},Rs={class:"order-count"},Ss={class:"order-summary-action"},Ds={class:"card-header"},Ps={key:0,class:"empty-history"},Ts={key:1,class:"order-history"},xs={class:"order-header"},Ms={class:"order-title"},Ns={class:"order-info"},Bs={class:"order-details"},zs={class:"order-type"},Vs={class:"order-date"},$s={class:"detail-side"},Es={class:"info-grid"},js={class:"info-row"},Qs={class:"info-value"},Ls={class:"info-row"},Ws={class:"info-value"},Fs={class:"info-row"},Us={class:"info-value"},Gs={class:"info-row"},Hs={class:"info-value"},Js={class:"card-header"},Ks={class:"qr-container"},Xs={class:"responsible-section"},Ys={class:"responsible-info"},Zs={class:"responsible-name"},se={class:"metrics"},ee={class:"metric-item"},te={class:"metric-value"},ie={class:"metric-item"},ae={class:"metric-value"},oe={class:"metric-item"},le={class:"metric-value"},ne={class:"metric-item"},de={class:"metric-value"},re={class:"metric-item"},ue={class:"metric-value"},ve={class:"metric-item"},ce={class:"metric-value"},me={key:1,class:"asset-not-found page"},pe=L({__name:"AssetDetail",setup(fe){const D=W(),k=X(),w=D.params.id,P=F(),T=U(),x=G(),o=g(()=>P.byId(w)),M=g(()=>{var t;return(t=o.value)!=null&&t.location?T.byId(o.value.location):null});function N(){return"https://lucassuzart.github.io/Manutencao"}const I=g(()=>`${N()}/ativos/${w}`),R=H(null);function B(){var u;const t=(u=R.value)==null?void 0:u.toDataURL();if(!t||!o.value)return;const e=window.open("","_blank","width=400,height=500");if(!e)return;const i=`
    <html>
    <head>
      <meta charset="utf-8" />
      <title>QR - ${o.value.name}</title>
      <style>
        body { font-family: Arial, sans-serif; text-align:center; padding: 12px; }
        img { width: 240px; height: 240px; }
        .name { margin-top: 8px; font-weight: 600; }
        .code { color: #555; }
      </style>
    </head>
    <body>
      <img src="${t}" alt="QR" />
      <div class="name">${o.value.name}</div>
      <div class="code">${o.value.code}</div>
      <script>window.onload = () => { window.print(); setTimeout(() => window.close(), 300); };<\/script>
    </body>
    </html>`;e.document.write(i),e.document.close()}const z=g(()=>[]),V=g(()=>"TIME MANUTENÇÃO");g(()=>{const t=v.value.filter(e=>e.type==="inspection"&&e.status==="completed");return t.length===0?null:t.sort((e,i)=>new Date(i.completedAt).getTime()-new Date(e.completedAt).getTime())[0].completedAt});const v=g(()=>o.value?x.workOrders.filter(t=>t.assetId===w).sort((t,e)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()):[]),f=g(()=>{if(!v.value.length)return{totalOrders:0,pendingOrders:0,lastMaintenance:null,completedOrders:0,completionRate:0,corrective:0,preventive:0};const t=v.value.length,e=v.value.filter(r=>r.status!=="completed"&&r.status!=="canceled").length,i=v.value.filter(r=>r.status==="completed").length,u=v.value.filter(r=>r.completedAt).sort((r,Q)=>new Date(Q.completedAt).getTime()-new Date(r.completedAt).getTime())[0],_=v.value.filter(r=>r.type==="corrective").length,y=v.value.filter(r=>r.type==="preventive"||r.type==="predictive"||r.type==="inspection").length;return{totalOrders:t,pendingOrders:e,completedOrders:i,completionRate:t?Math.round(i/t*100):0,lastMaintenance:(u==null?void 0:u.completedAt)||null,corrective:_,preventive:y}});function q(t){return t?new Date(t).toLocaleDateString("pt-BR"):"N/A"}function $(){k.push({name:"assets-edit",params:{id:w}})}function E(){var t;k.push({name:"workorders-new",query:{assetId:w,assetName:(t=o.value)==null?void 0:t.name}})}function j(t){k.push({name:"workorder-detail",params:{id:t}})}function S(t){k.push({name:"workorders",query:{assetId:w,status:t==="pending"?["open","in_progress","paused"]:["completed"]}})}return(t,e)=>o.value?(c(),h("div",ss,[s("div",es,[s("div",ts,[e[3]||(e[3]=s("div",{class:"asset-icon"},[s("i",{class:"fas fa-cogs"})],-1)),s("div",is,[s("h1",null,l(o.value.name),1),s("p",as,"Código: "+l(o.value.code),1)])]),s("div",null,[d(n(b),{variant:"secondary",onClick:$},{default:a(()=>[...e[4]||(e[4]=[m("Editar",-1)])]),_:1})])]),s("div",os,[s("div",ls,[d(n(p),{class:"asset-image-card"},{default:a(()=>[...e[5]||(e[5]=[s("div",{class:"asset-image-container"},[s("img",{src:"https://via.placeholder.com/400x300?text=Imagem+do+Equipamento",alt:"Imagem do equipamento",class:"asset-image"})],-1)])]),_:1}),d(n(p),null,{header:a(()=>[...e[6]||(e[6]=[s("h3",null,"Informações de Manutenção",-1)])]),default:a(()=>{var i,u,_,y;return[s("div",ns,[s("div",ds,[e[7]||(e[7]=s("div",{class:"info-label"},"Status:",-1)),s("div",rs,[o.value.status?(c(),A(n(C),{key:0,status:o.value.status,type:"asset"},null,8,["status"])):O("",!0)])]),s("div",us,[e[8]||(e[8]=s("div",{class:"info-label"},"Criticidade:",-1)),s("div",vs,[o.value.criticality?(c(),A(n(C),{key:0,status:o.value.criticality,type:"criticality"},null,8,["status"])):O("",!0)])]),s("div",cs,[e[9]||(e[9]=s("div",{class:"info-label"},"Instalação:",-1)),s("div",ms,l(q((i=o.value)==null?void 0:i.installationDate)),1)]),s("div",ps,[e[10]||(e[10]=s("div",{class:"info-label"},"Última falha:",-1)),s("div",fs,l(q((u=o.value)==null?void 0:u.lastFailureAt)),1)]),s("div",gs,[e[11]||(e[11]=s("div",{class:"info-label"},"Último reparo:",-1)),s("div",_s,l(q((_=o.value)==null?void 0:_.lastRepairAt)),1)]),s("div",ys,[e[12]||(e[12]=s("div",{class:"info-label"},"Localização:",-1)),s("div",hs,l(((y=M.value)==null?void 0:y.name)||"-"),1)])])]}),_:1}),d(n(p),null,{header:a(()=>[...e[13]||(e[13]=[s("h3",null,"Solicitações",-1)])]),default:a(()=>[z.value.length?O("",!0):(c(),h("div",bs,[...e[14]||(e[14]=[s("p",null,"Nenhuma solicitação de manutenção planejada para este ativo.",-1)])])),e[15]||(e[15]=s("div",{class:"request-list"},[s("div",{class:"request-item"},[s("div",{class:"request-icon"},[s("i",{class:"fas fa-clipboard-list"})]),s("div",{class:"request-content"},[s("div",{class:"request-title"},"Verificação das Pás"),s("div",{class:"tag-container"},[s("span",{class:"tag tag-success"},"Planejada")])])]),s("div",{class:"request-item"},[s("div",{class:"request-icon"},[s("i",{class:"fas fa-search"})]),s("div",{class:"request-content"},[s("div",{class:"request-title"},"Inspeção Preventiva"),s("div",{class:"tag-container"},[s("span",{class:"tag tag-success"},"Planejada")])])]),s("div",{class:"request-item"},[s("div",{class:"request-icon"},[s("i",{class:"fas fa-clipboard-list"})]),s("div",{class:"request-content"},[s("div",{class:"request-title"},"Verificação das Pás"),s("div",{class:"tag-container"},[s("span",{class:"tag tag-success"},"Planejada")])])]),s("div",{class:"request-item"},[s("div",{class:"request-icon"},[s("i",{class:"fas fa-search"})]),s("div",{class:"request-content"},[s("div",{class:"request-title"},"Inspeção Preventiva"),s("div",{class:"tag-container"},[s("span",{class:"tag tag-success"},"Planejada")])])])],-1))]),_:1}),d(n(p),null,{header:a(()=>[...e[16]||(e[16]=[s("h3",null,"Ordens de Serviço",-1)])]),default:a(()=>[s("div",ws,[s("div",ks,[s("div",qs,[e[17]||(e[17]=s("span",null,"Em aberto:",-1)),s("span",Os,l(f.value.pendingOrders),1)]),s("div",As,[d(n(b),{variant:"ghost",size:"sm",onClick:e[0]||(e[0]=i=>S("pending"))},{default:a(()=>[...e[18]||(e[18]=[m("Visualizar →",-1)])]),_:1})])]),s("div",Cs,[s("div",Is,[e[19]||(e[19]=s("span",null,"Concluídas:",-1)),s("span",Rs,l(f.value.completedOrders),1)]),s("div",Ss,[d(n(b),{variant:"ghost",size:"sm",onClick:e[1]||(e[1]=i=>S("completed"))},{default:a(()=>[...e[20]||(e[20]=[m("Visualizar →",-1)])]),_:1})])])])]),_:1}),d(n(p),{class:"history-card"},{header:a(()=>[s("div",Ds,[e[22]||(e[22]=s("h3",null,"Histórico de Manutenção",-1)),d(n(b),{variant:"primary",size:"sm",onClick:E},{default:a(()=>[...e[21]||(e[21]=[m("Nova OS",-1)])]),_:1})])]),default:a(()=>[v.value.length===0?(c(),h("div",Ps,[...e[23]||(e[23]=[s("p",null,"Nenhuma ordem de serviço registrada para este ativo.",-1)])])):(c(),h("div",Ts,[(c(!0),h(J,null,K(v.value,i=>(c(),h("div",{key:i.id,class:"order-item"},[s("div",xs,[s("div",Ms,[s("strong",null,l(i.code),1),m(" - "+l(i.title),1)]),d(n(C),{status:i.status,type:"workorder"},null,8,["status"])]),s("div",Ns,[s("div",Bs,[s("div",zs,[e[24]||(e[24]=s("span",{class:"label"},"Tipo:",-1)),m(" "+l(i.type==="corrective"?"Corretiva":i.type==="preventive"?"Preventiva":i.type==="predictive"?"Preditiva":i.type==="inspection"?"Inspeção":"Melhoria"),1)]),s("div",Vs,[e[25]||(e[25]=s("span",{class:"label"},"Data:",-1)),m(" "+l(q(i.createdAt)),1)])]),d(n(b),{variant:"ghost",size:"sm",onClick:u=>j(i.id)},{default:a(()=>[...e[26]||(e[26]=[m(" Ver detalhes ",-1)])]),_:1},8,["onClick"])])]))),128))]))]),_:1})]),s("div",$s,[d(n(p),null,{header:a(()=>[...e[27]||(e[27]=[s("h3",null,"Informações Gerais",-1)])]),default:a(()=>{var i,u,_,y;return[s("div",Es,[s("div",js,[e[28]||(e[28]=s("div",{class:"info-label"},"Modelo:",-1)),s("div",Qs,l(((i=o.value)==null?void 0:i.model)||"Motobomba"),1)]),s("div",Ls,[e[29]||(e[29]=s("div",{class:"info-label"},"Fabricante:",-1)),s("div",Ws,l(((u=o.value)==null?void 0:u.manufacturer)||"-"),1)]),s("div",Fs,[e[30]||(e[30]=s("div",{class:"info-label"},"Série:",-1)),s("div",Us,l(((_=o.value)==null?void 0:_.serialNumber)||"-"),1)]),s("div",Gs,[e[31]||(e[31]=s("div",{class:"info-label"},"Categoria:",-1)),s("div",Hs,l(((y=o.value)==null?void 0:y.category)||"-"),1)])])]}),_:1}),d(n(p),null,{header:a(()=>[s("div",Js,[e[33]||(e[33]=s("h3",null,"Código QR",-1)),d(n(b),{size:"sm",variant:"secondary",onClick:B},{default:a(()=>[...e[32]||(e[32]=[m("🖨️ Imprimir",-1)])]),_:1})])]),default:a(()=>[s("div",Ks,[o.value?(c(),A(Z,{key:0,ref_key:"qrRef",ref:R,value:I.value,caption:I.value},null,8,["value","caption"])):O("",!0)])]),_:1}),d(n(p),null,{header:a(()=>[...e[34]||(e[34]=[s("h3",null,"Responsável",-1)])]),default:a(()=>[s("div",Xs,[e[36]||(e[36]=s("div",{class:"responsible-avatar"},[s("i",{class:"fas fa-user-hard-hat"})],-1)),s("div",Ys,[s("div",Zs,l(V.value),1),e[35]||(e[35]=s("div",{class:"responsible-role"},"Equipe de manutenção",-1))])])]),_:1}),d(n(p),null,{header:a(()=>[...e[37]||(e[37]=[s("h3",null,"Métricas",-1)])]),default:a(()=>[s("div",se,[s("div",ee,[e[38]||(e[38]=s("div",{class:"metric-label"},"Total OS:",-1)),s("div",te,l(f.value.totalOrders),1)]),s("div",ie,[e[39]||(e[39]=s("div",{class:"metric-label"},"OS Pendentes:",-1)),s("div",ae,l(f.value.pendingOrders),1)]),s("div",oe,[e[40]||(e[40]=s("div",{class:"metric-label"},"Taxa Conclusão:",-1)),s("div",le,l(f.value.completionRate)+"%",1)]),s("div",ne,[e[41]||(e[41]=s("div",{class:"metric-label"},"Última Manutenção:",-1)),s("div",de,l(q(f.value.lastMaintenance)),1)]),s("div",re,[e[42]||(e[42]=s("div",{class:"metric-label"},"OS Corretivas:",-1)),s("div",ue,l(f.value.corrective),1)]),s("div",ve,[e[43]||(e[43]=s("div",{class:"metric-label"},"OS Preventivas:",-1)),s("div",ce,l(f.value.preventive),1)])])]),_:1})])])])):(c(),h("div",me,[e[45]||(e[45]=s("h2",null,"Ativo não encontrado",-1)),e[46]||(e[46]=s("p",null,"O ativo solicitado não existe ou foi removido.",-1)),d(n(b),{variant:"primary",onClick:e[2]||(e[2]=i=>n(k).push({name:"assets"}))},{default:a(()=>[...e[44]||(e[44]=[m("Voltar para Ativos",-1)])]),_:1})]))}}),ye=Y(pe,[["__scopeId","data-v-86e2bb9e"]]);export{ye as default};
